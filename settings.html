<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cài đặt hệ thống - Smart Power Management System">
    <title>Cài đặt - Hệ Thống Giám Sát Điện Năng</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Animated Background -->
    <div class="bg-animation">
        <div class="bg-gradient"></div>
        <div class="floating-orbs">
            <div class="orb orb-1"></div>
            <div class="orb orb-2"></div>
            <div class="orb orb-3"></div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="logo.png" alt="HCMUTE Logo" class="logo-img">
                <span class="logo-text">HCMUTE</span>
            </div>
            <div class="nav-menu">
                <a href="index.html" class="nav-link">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </a>
                <a href="index.html#rooms" class="nav-link">
                    <i class="fas fa-door-open"></i>
                    <span>Phòng</span>
                </a>
                <a href="settings.html" class="nav-link active">
                    <i class="fas fa-cog"></i>
                    <span>Cài đặt</span>
                </a>
            </div>
            <div class="nav-user">
                <div class="info-btn" id="infoBtn" title="Thông tin đồ án">
                    <i class="fas fa-info-circle"></i>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Settings Section -->
        <section class="settings-section" id="settings">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-cog"></i>
                    Cài đặt hệ thống
                </h2>
            </div>
            <div class="settings-grid">
                <!-- Thresholds Card -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div class="settings-icon warning">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <h3>Ngưỡng cảnh báo</h3>
                    </div>
                    <div class="settings-card-body">
                        <div class="threshold-edit-form">
                            <div class="threshold-edit-row">
                                <div class="threshold-edit-label">
                                    <i class="fas fa-exclamation-circle warning-icon"></i>
                                    <span>Ngưỡng cảnh báo</span>
                                </div>
                                <div class="threshold-edit-input">
                                    <input type="number" id="warningThresholdInput" class="threshold-input" value="502">
                                    <span class="threshold-unit">W</span>
                                </div>
                            </div>
                            <div class="threshold-edit-row">
                                <div class="threshold-edit-label">
                                    <i class="fas fa-bolt critical-icon"></i>
                                    <span>Ngưỡng nguy hiểm</span>
                                </div>
                                <div class="threshold-edit-input">
                                    <input type="number" id="criticalThresholdInput" class="threshold-input"
                                        value="1000">
                                    <span class="threshold-unit">W</span>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-save btn-save-sm" id="saveThresholdBtn">
                            <i class="fas fa-save"></i>
                            Lưu ngưỡng
                        </button>
                        <div class="save-status" id="thresholdSaveStatus"></div>
                    </div>
                </div>

                <!-- Room Thresholds Card -->
                <div class="settings-card room-threshold-card">
                    <div class="settings-card-header">
                        <div class="settings-icon danger">
                            <i class="fas fa-door-open"></i>
                        </div>
                        <h3>Ngưỡng cảnh báo từng phòng</h3>
                    </div>
                    <div class="settings-card-body">
                        <div class="room-threshold-form" id="roomThresholdForm">
                            <!-- Rooms will be loaded dynamically from API -->
                            <div class="room-threshold-loading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <span>Đang tải danh sách phòng...</span>
                            </div>
                        </div>

                        <button class="btn btn-save btn-save-sm" id="saveRoomThresholdBtn">
                            <i class="fas fa-save"></i>
                            Lưu ngưỡng phòng
                        </button>
                        <div class="save-status" id="roomThresholdSaveStatus"></div>
                    </div>
                </div>

                <!-- Tier Prices Card -->

                <div class="settings-card tier-card">
                    <div class="settings-card-header">
                        <div class="settings-icon success">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h3>Giá điện bậc thang</h3>
                    </div>
                    <div class="settings-card-body">
                        <div class="tier-edit-form" id="tierEditForm">
                            <!-- Tier 1 -->
                            <div class="tier-edit-row">
                                <div class="tier-edit-label">
                                    <span class="tier-name">Bậc 1</span>
                                    <span class="tier-range">0 - <input type="number" id="tierLimit1"
                                            class="tier-limit-input" value="50"> kWh</span>
                                </div>
                                <div class="tier-edit-price">
                                    <input type="number" id="tierPrice1" class="tier-price-input" value="1984">
                                    <span class="tier-unit">đ/kWh</span>
                                </div>
                            </div>
                            <!-- Tier 2 -->
                            <div class="tier-edit-row">
                                <div class="tier-edit-label">
                                    <span class="tier-name">Bậc 2</span>
                                    <span class="tier-range"><span id="tierLimit1Display">51</span> - <input
                                            type="number" id="tierLimit2" class="tier-limit-input" value="100">
                                        kWh</span>
                                </div>
                                <div class="tier-edit-price">
                                    <input type="number" id="tierPrice2" class="tier-price-input" value="2050">
                                    <span class="tier-unit">đ/kWh</span>
                                </div>
                            </div>
                            <!-- Tier 3 -->
                            <div class="tier-edit-row">
                                <div class="tier-edit-label">
                                    <span class="tier-name">Bậc 3</span>
                                    <span class="tier-range"><span id="tierLimit2Display">101</span> - <input
                                            type="number" id="tierLimit3" class="tier-limit-input" value="200">
                                        kWh</span>
                                </div>
                                <div class="tier-edit-price">
                                    <input type="number" id="tierPrice3" class="tier-price-input" value="2380">
                                    <span class="tier-unit">đ/kWh</span>
                                </div>
                            </div>
                            <!-- Tier 4 -->
                            <div class="tier-edit-row">
                                <div class="tier-edit-label">
                                    <span class="tier-name">Bậc 4</span>
                                    <span class="tier-range"><span id="tierLimit3Display">201</span> - <input
                                            type="number" id="tierLimit4" class="tier-limit-input" value="300">
                                        kWh</span>
                                </div>
                                <div class="tier-edit-price">
                                    <input type="number" id="tierPrice4" class="tier-price-input" value="2998">
                                    <span class="tier-unit">đ/kWh</span>
                                </div>
                            </div>
                            <!-- Tier 5 -->
                            <div class="tier-edit-row">
                                <div class="tier-edit-label">
                                    <span class="tier-name">Bậc 5</span>
                                    <span class="tier-range"><span id="tierLimit4Display">301</span> - <input
                                            type="number" id="tierLimit5" class="tier-limit-input" value="400">
                                        kWh</span>
                                </div>
                                <div class="tier-edit-price">
                                    <input type="number" id="tierPrice5" class="tier-price-input" value="3350">
                                    <span class="tier-unit">đ/kWh</span>
                                </div>
                            </div>
                            <!-- Tier 6 -->
                            <div class="tier-edit-row">
                                <div class="tier-edit-label">
                                    <span class="tier-name">Bậc 6</span>
                                    <span class="tier-range">> <span id="tierLimit5Display">400</span> kWh</span>
                                </div>
                                <div class="tier-edit-price">
                                    <input type="number" id="tierPrice6" class="tier-price-input" value="3460">
                                    <span class="tier-unit">đ/kWh</span>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-save" id="saveTierBtn">
                            <i class="fas fa-save"></i>
                            Lưu thay đổi
                        </button>
                        <div class="save-status" id="saveStatus"></div>
                    </div>
                </div>

                <!-- VAT Card -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div class="settings-icon info">
                            <i class="fas fa-percent"></i>
                        </div>
                        <h3>Thuế VAT</h3>
                    </div>
                    <div class="settings-card-body">
                        <div class="vat-edit-form">
                            <div class="vat-input-wrapper">
                                <input type="number" id="vatInput" class="vat-input" value="8" min="0" max="100">
                                <span class="vat-input-symbol">%</span>
                            </div>
                            <p class="vat-note">Thuế giá trị gia tăng áp dụng cho hóa đơn điện</p>
                        </div>
                        <button class="btn btn-save btn-save-sm" id="saveVatBtn">
                            <i class="fas fa-save"></i>
                            Lưu thuế VAT
                        </button>
                        <div class="save-status" id="vatSaveStatus"></div>
                    </div>
                </div>

                <!-- Email Alerts Card -->
                <div class="settings-card email-card email-card-wide">
                    <div class="settings-card-header">
                        <div class="settings-icon primary">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <h3>Cảnh báo Email</h3>
                    </div>
                    <div class="settings-card-body">
                        <div class="email-edit-form">
                            <div class="email-toggle-row">
                                <div class="email-toggle-label">
                                    <i class="fas fa-bell"></i>
                                    <span>Bật thông báo email</span>
                                </div>
                                <div class="email-toggle-switch">
                                    <input type="checkbox" id="emailEnabled" class="toggle-checkbox">
                                    <label for="emailEnabled" class="toggle-label"></label>
                                </div>
                            </div>
                            <div class="email-config-section" id="emailConfigSection">
                                <div class="email-edit-row">
                                    <div class="email-edit-label">
                                        <i class="fas fa-user"></i>
                                        <span>Email nhận cảnh báo</span>
                                    </div>
                                    <div class="email-edit-input">
                                        <input type="email" id="emailRecipient" class="email-input"
                                            placeholder="your@email.com">
                                    </div>
                                </div>
                                <div class="email-edit-row">
                                    <div class="email-edit-label">
                                        <i class="fas fa-at"></i>
                                        <span>Email gửi (sender)</span>
                                    </div>
                                    <div class="email-edit-input">
                                        <input type="email" id="senderEmail" class="email-input"
                                            placeholder="sender@gmail.com">
                                    </div>
                                </div>
                                <div class="email-edit-row">
                                    <div class="email-edit-label">
                                        <i class="fas fa-key"></i>
                                        <span>App Password</span>
                                    </div>
                                    <div class="email-edit-input">
                                        <input type="password" id="senderPassword" class="email-input"
                                            placeholder="••••••••••••">
                                    </div>
                                </div>
                                <div class="email-edit-row">
                                    <div class="email-edit-label">
                                        <i class="fas fa-server"></i>
                                        <span>SMTP Server</span>
                                    </div>
                                    <div class="email-edit-input">
                                        <input type="text" id="smtpServer" class="email-input" value="smtp.gmail.com">
                                    </div>
                                </div>
                                <div class="email-edit-row">
                                    <div class="email-edit-label">
                                        <i class="fas fa-plug"></i>
                                        <span>SMTP Port</span>
                                    </div>
                                    <div class="email-edit-input">
                                        <input type="number" id="smtpPort" class="email-input" value="587">
                                    </div>
                                </div>

                                <!-- Divider -->
                                <div class="email-divider"></div>

                                <!-- Alert Cooldown -->
                                <div class="email-edit-row">
                                    <div class="email-edit-label">
                                        <i class="fas fa-clock"></i>
                                        <span>Thời gian giữa cảnh báo</span>
                                    </div>
                                    <div class="email-edit-input">
                                        <input type="number" id="alertCooldown" class="email-input email-input-sm"
                                            value="5" min="1" max="60">
                                        <span class="email-unit">phút</span>
                                    </div>
                                </div>

                                <!-- Daily Report -->
                                <div class="email-edit-row">
                                    <div class="email-edit-label">
                                        <i class="fas fa-calendar-day"></i>
                                        <span>Gửi báo cáo hằng ngày lúc</span>
                                    </div>
                                    <div class="email-edit-input">
                                        <input type="time" id="dailyReportTime" class="email-input email-input-sm"
                                            value="08:00">
                                    </div>
                                </div>

                                <p class="email-note">
                                    <i class="fas fa-info-circle"></i>
                                    Với Gmail, sử dụng <a href="https://myaccount.google.com/apppasswords"
                                        target="_blank">App Password</a> thay vì mật khẩu thường.
                                </p>
                            </div>
                        </div>
                        <div class="email-btn-group">
                            <button class="btn btn-save btn-save-sm" id="saveEmailBtn">
                                <i class="fas fa-save"></i>
                                Lưu cấu hình
                            </button>
                            <button class="btn btn-test btn-save-sm" id="testEmailBtn">
                                <i class="fas fa-paper-plane"></i>
                                Gửi test
                            </button>
                        </div>
                        <div class="save-status" id="emailSaveStatus"></div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-brand">
                <img src="logo.png" alt="HCMUTE Logo" class="footer-logo">
                <span>HCMUTE - Hệ thống giám sát điện năng thông minh</span>
            </div>
            <div class="footer-info">
                <span>© 2025 ĐATN - Điều khiển và giám sát điện năng</span>
            </div>
        </div>
    </footer>

    <!-- API Scripts -->
    <script src="data.js"></script>
    <script src="app.js"></script>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-question-circle"></i>
            </div>
            <h3 class="modal-title">Xác nhận lưu thay đổi</h3>
            <p class="modal-message">Bạn có chắc chắn muốn lưu các thay đổi giá điện bậc thang?</p>
            <div class="modal-actions">
                <button class="btn btn-cancel" id="modalCancelBtn">
                    <i class="fas fa-times"></i>
                    Hủy
                </button>
                <button class="btn btn-confirm" id="modalConfirmBtn">
                    <i class="fas fa-check"></i>
                    Xác nhận
                </button>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div class="modal-overlay" id="infoModal">
        <div class="modal-content info-modal-content">
            <button class="modal-close-btn" id="infoModalClose">
                <i class="fas fa-times"></i>
            </button>
            <div class="info-modal-header">
                <div class="info-modal-logo">
                    <img src="logo.png" alt="HCMUTE Logo">
                </div>
                <h2>ĐỒ ÁN TỐT NGHIỆP</h2>
            </div>
            <div class="info-modal-body">
                <div class="project-title">
                    <i class="fas fa-bolt"></i>
                    <h3>HỆ THỐNG ĐIỀU KHIỂN VÀ GIÁM SÁT ĐIỆN NĂNG</h3>
                </div>
                <div class="project-details">
                    <div class="detail-item">
                        <span class="detail-label">Trường:</span>
                        <span class="detail-value">Đại học Sư phạm Kỹ thuật TP.HCM</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Khoa:</span>
                        <span class="detail-value">Điện - Điện tử</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Năm:</span>
                        <span class="detail-value">2025</span>
                    </div>
                </div>
                <div class="team-section">
                    <h4><i class="fas fa-users"></i> Thành viên thực hiện</h4>
                    <div class="team-members">
                        <div class="member-card">
                            <div class="member-avatar">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                            <div class="member-info">
                                <span class="member-name">Nguyễn Lê Phúc Khương</span>
                                <span class="member-id">MSSV: 20161216</span>
                            </div>
                        </div>
                        <div class="member-card">
                            <div class="member-avatar">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                            <div class="member-info">
                                <span class="member-name">Nguyễn Chí Phúc</span>
                                <span class="member-id">MSSV: 20161244</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="advisor-section">
                    <h4><i class="fas fa-chalkboard-teacher"></i> Giảng viên hướng dẫn</h4>
                    <div class="advisor-info">
                        <div class="advisor-avatar">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <span class="advisor-name">GVC. ThS. Võ Đức Dũng</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>